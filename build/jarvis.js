!function(){"use strict";var e=window.wp.element,t=window.wp.compose,n=window.wp.blockEditor,r=window.wp.components,s=window.wp.data,l=window.lodash,o=(window.wp.keycodes,window.wp.editPost);const a=()=>(0,e.createElement)(r.Icon,{icon:()=>(0,e.createElement)("svg",{height:"512",viewBox:"0 0 512 512",width:"512",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)("g",null,(0,e.createElement)("path",{style:{clipRule:"evenodd",fillRule:"evenodd",strokeWidth:22,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:10},d:"m65.443359 0c-36.065554 0-65.443359 29.379759-65.443359 65.445312v381.111328c0 36.06556 29.377805 65.44336 65.443359 65.44336h381.113281c36.06554 0 65.44336-29.3778 65.44336-65.44336v-381.111328c0-36.065553-29.37782-65.445312-65.44336-65.445312zm189.878911 121.58789c10.34952.24059 21.20005 7.47409 24.16211 19.32031v.002l56.04687 224.18945c.48413 1.93685 2.0851 3.23775 4.08008 3.31445 1.995.0767 3.69274-1.09629 4.32422-2.99023l29.14453-87.41797c6.62354-19.86666 25.31038-33.33225 46.25195-33.33203h.002 27.22071a11.000017 11.000031 0 0 1 11 11.00195 11.000017 11.000031 0 0 1 -11 10.99805h-27.22266c-11.55733-.00059-21.72547 7.32701-25.38086 18.29101l-29.14453 87.41602a11.001117 11.001131 0 0 0 0 .002c-3.6943 11.08001-14.36805 18.46455-26.03906 18.01563s-21.7478-8.63185-24.58008-19.96289l-56.04693-224.1915c-.61641-2.46602-1.64072-2.62281-3.33007-2.66211s-2.71887.0692-3.44922 2.50391l-51.50195 171.68554c-3.97935 13.2649-15.73162 21.43652-27.6211 22.4629-11.88948 1.02635-24.86876-5.00979-31.0625-17.39649l-18.95508-37.90625c-5.60537-11.20999-17.00767-18.25778-29.541012-18.25781h-27.234376a11.000017 11.000031 0 0 1 -11-11 11.000017 11.000031 0 0 1 11-11h27.234376c20.819612.00005 39.907432 11.79658 49.218752 30.41797l18.95508 37.9082c2.18259 4.36493 5.66711 5.64466 9.49218 5.31445 3.82507-.3302 7.03914-2.18887 8.44141-6.86328l51.50195-171.68555c3.50874-11.69687 14.68317-18.41834 25.03321-18.17773z"})))});window.wp.editor,window.wp.url;var i=window.wp.blocks;const c=(e,t)=>{fetch("/wp-json/jarvis/v1/seo",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":jarvisSettings.nonce},body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{t(e)})).catch((e=>{console.error("Error fetching data:",e)}))};function u(){const[t,n]=(0,e.useState)(!1),{editPost:o}=(0,s.dispatch)("core/editor"),{hasKeyWords:a,currentTitle:i,suggestedKeywords:u}=(0,s.useSelect)((e=>{const{getKeywords:t}=e("rank-math"),{getEditedPostAttribute:n,getEditedPostContent:r}=e("core/editor");return{hasKeyWords:t(),currentTitle:n("title"),suggestedKeywords:n("suggestedKeywords")||[]}}));return(0,e.createElement)(e.Fragment,null,(!a||0==u.length)&&(0,e.createElement)(r.Button,{isBusy:t,className:"news-crawler-button",variant:"primary",onClick:()=>{n(!0),c({value:i,attribute:"keywords"},(e=>{let t=(0,l.get)(e,"results",[]);o({suggestedKeywords:t}),n(!1)}))}},"Search SEO Keywords"),0!==u.length&&(0,e.createElement)("div",null,(0,e.createElement)("h3",null,"Suggested Keywords:"),(0,e.createElement)("ul",{className:"tpd-jarvis-seo-results"},u.map((t=>(0,e.createElement)("li",{className:"tpd-jarvis-seo-item",onClick:()=>{(0,s.dispatch)("rank-math").updateKeywords(t)}},t))))))}function d(t){const[n,o]=(0,e.useState)(!1),{editPost:a}=(0,s.dispatch)("core/editor"),{keywords:i,currentTitle:u,suggestedTitles:d}=(0,s.useSelect)((e=>{const{getKeywords:t}=e("rank-math"),{getEditedPostAttribute:n,getEditedPostContent:r}=e("core/editor");return{keywords:t(),currentTitle:n("title"),suggestedTitles:n("suggestedTitles")||[]}}));return(0,e.createElement)(e.Fragment,null,i&&0==d.length&&(0,e.createElement)(r.Button,{isBusy:n,className:"news-crawler-button",variant:"primary",onClick:()=>{let e={value:u,value2:i,attribute:"title"};o(!0),c(e,(e=>{let t=(0,l.get)(e,"results",[]);a({suggestedTitles:t}),o(!1)}))}},"Search SEO titles"),i&&0!==d.length&&(0,e.createElement)("div",null,(0,e.createElement)("h3",null,"Titles:"),(0,e.createElement)("ul",null,d.map((t=>(0,e.createElement)("li",{onClick:()=>{a({title:t})}},t))))))}function g(){const[t,n]=(0,e.useState)(!1),{editPost:o}=(0,s.dispatch)("core/editor"),{keywords:a,currentTitle:i,suggestedDescriptions:u}=(0,s.useSelect)((e=>{const{getKeywords:t}=e("rank-math"),{getEditedPostAttribute:n,getEditedPostContent:r}=e("core/editor");return{keywords:t(),currentTitle:n("title"),suggestedDescriptions:n("suggestedDescriptions")||[]}}));return(0,e.createElement)(e.Fragment,null,a&&0==u.length&&(0,e.createElement)(r.Button,{isBusy:t,className:"news-crawler-button",variant:"primary",onClick:()=>{let e={value:i,value2:a,attribute:"description"};n(!0),c(e,(e=>{let t=(0,l.get)(e,"results",[]);o({suggestedDescriptions:t}),n(!1)}))}},"Search SEO Descriptions"),a&&0!==u.length&&(0,e.createElement)("div",null,(0,e.createElement)("h3",null,"Descriptions:"),(0,e.createElement)("ul",null,u.map((t=>(0,e.createElement)("li",{onClick:()=>{o({excerpt:t}),(0,s.dispatch)("rank-math").updateDescription(t)}},t))))))}function m(){const[t,n]=(0,e.useState)(!1),{editPost:o}=(0,s.dispatch)("core/editor"),{keywords:a,currentSlug:i,suggestedPermalink:u}=(0,s.useSelect)((e=>{const{getKeywords:t}=e("rank-math"),{getEditedPostAttribute:n,getEditedPostContent:r}=e("core/editor");return{keywords:t(),currentSlug:n("slug"),suggestedPermalink:n("suggestedPermalink")||[]}}));return(0,e.createElement)(e.Fragment,null,a&&0==u.length&&(0,e.createElement)(r.Button,{isBusy:t,className:"news-crawler-button",variant:"primary",onClick:()=>{let e={value:i,value2:a,attribute:"url"};n(!0),c(e,(e=>{let t=(0,l.get)(e,"results",[]);o({suggestedPermalink:t}),n(!1)}))}},"Search SEO Permalink"),a&&0!==u.length&&(0,e.createElement)("div",null,(0,e.createElement)("h3",null,"Suggested permalinks/slugs:"),(0,e.createElement)("ul",null,u.map((t=>(0,e.createElement)("li",{onClick:()=>{o({slug:t})}},"/",t))))))}const w=(e,t)=>{fetch("/wp-json/jarvis/v1/write",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":jarvisSettings.nonce},body:JSON.stringify({content:e})}).then((e=>e.json())).then((e=>{t(e)})).catch((e=>{console.error("Error fetching data:",e)}))},p=e=>{const{replaceBlocks:t}=(0,s.dispatch)("core/editor");var n;t((0,s.select)("core/block-editor").getBlocks().map((e=>e.clientId)),(n=e,(0,i.pasteHandler)({HTML:n})))};function h(){const[t,n]=(0,e.useState)(!1),{getEditedPostContent:o}=(0,s.select)("core/editor");return(0,e.createElement)(r.Button,{isBusy:t,className:"news-crawler-button",variant:"primary",onClick:()=>{const e=o();e&&(n(!0),w(e,(e=>{let t=(0,l.get)(e,"result",null);null!=t?(p(t),n(!1)):n(!1)})))}},"Rewrite Article")}function E(){const[t,n]=(0,e.useState)(!1),[r,l]=(0,e.useState)([]),[o,a]=(0,e.useState)([]),[i,c]=(0,e.useState)([]),{getEditedPostAttribute:w,getEditedPostContent:p}=(0,s.select)("core/editor"),{getKeywords:h}=(0,s.select)("rank-math"),{editPost:E}=(0,s.dispatch)("core/editor");return h(),(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"jarvis-suggestions"},(0,e.createElement)(u,null),(0,e.createElement)(d,null),(0,e.createElement)(g,null),(0,e.createElement)(m,null)))}function y(){return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o.PluginSidebarMoreMenuItem,{target:"jarvis-sidebar"},"Jarvis"),(0,e.createElement)(o.PluginSidebar,{className:"jarvis-sidebar",name:"jarvis-sidebar",title:"Jarvis",icon:a},(0,e.createElement)(h,null),(0,e.createElement)(E,null)))}const{registerPlugin:v}=wp.plugins;v("jarvis-sidebar",{render:function(){return(0,e.createElement)(y,null)}});const k=(0,t.createHigherOrderComponent)((t=>l=>{if("core/paragraph"!==l.name)return(0,e.createElement)(t,l);const[o,a]=(0,e.useState)(!1),{attributes:{content:i},setAttributes:c}=l,u=(0,s.select)("core/editor").getCurrentPostAttribute("title");return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t,l),(0,e.createElement)(n.InspectorControls,null,(0,e.createElement)(r.PanelBody,null,(0,e.createElement)(r.Button,{variant:"secondary",isBusy:o,onClick:()=>{(async()=>{try{a(!0);const e=await fetch("/wp-json/openai/v1/create_completion",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:i,title:u})}),t=await e.json();if(200!==e.status)throw t.error||new Error(`Request failed with status ${e.status}`);console.log(t),c({content:t.result}),a(!1)}catch(e){console.error(e),alert(e.message)}})()}},"Rewrite"))))}),"withInspectorControl");wp.hooks.addFilter("editor.BlockEdit","my-plugin/with-inspector-controls",k)}();